{{- if eq .Values.TALK_ENABLED "yes" }}
---
apiVersion: v1
kind: Service
metadata:
  annotations:
    kompose.cmd: kompose convert -c -f latest.yml --namespace {{ .Values.NAMESPACE }}
    kompose.version: 1.31.2 (a92241f79)
  labels:
    io.kompose.service: nextcloud-aio-talk
  name: nextcloud-aio-talk-public
  namespace: {{ .Values.NAMESPACE }}
spec:
  type: LoadBalancer
  externalTrafficPolicy: Local
  ports:
    - name: "{{ .Values.TALK_PORT }}"
      port: {{ .Values.TALK_PORT }}
      targetPort: {{ .Values.TALK_PORT }}
    - name: {{ .Values.TALK_PORT }}-udp
      port: {{ .Values.TALK_PORT }}
      protocol: UDP
      targetPort: {{ .Values.TALK_PORT }}
  selector:
    io.kompose.service: nextcloud-aio-talk
---
apiVersion: v1
kind: Service
metadata:
  annotations:
    kompose.cmd: kompose convert -c -f latest.yml --namespace {{ .Values.NAMESPACE }}
    kompose.version: 1.31.2 (a92241f79)
  labels:
    io.kompose.service: nextcloud-aio-talk
  name: nextcloud-aio-talk
  namespace: {{ .Values.NAMESPACE }}
spec:
  ports:
    - name: "8081"
      port: 8081
      targetPort: 8081
  selector:
    io.kompose.service: nextcloud-aio-talk
{{- end }}
