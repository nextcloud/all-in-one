<html lang="en">
    <head>
        <style>
            button {
                position: fixed;
                top: 1rem;
                right: 1rem;
                font-size: 1.3rem;
            }
        </style>
        <script>
            window.addEventListener("load", (event) => {
                // Scroll to the bottom of the page where the newest log entries are.
                window.scrollTo(0, document.body.scrollHeight);
                // Put a second instruction to scroll to the bottom onto the stack to give the browser a
                // better chance to render all text and calculate the scrollHeight, in case the first
                // call was too early.
                setTimeout(() => window.scrollTo(0, document.body.scrollHeight), 0);
                // Do it again just in case the previous calls were both still too quick.
                setTimeout(() => window.scrollTo(0, document.body.scrollHeight), 100);
                // Reload after a short while if the window is visible to the user. 
                const reloadTimer = setTimeout(() =>  {
                    if (document.visibilityState === 'visible') {
                        location.reload()
                    }
                }, 5000);
                // Provide a button that allows to disable the reloads.
                const button = document.querySelector('button');
                document.querySelector('button').addEventListener('click', (event) => {
                    event.preventDefault();
                    clearTimeout(reloadTimer);
                    button.disabled = true;
                    button.textContent = 'Reloading was disabled';
                });
                // Reload immediately if the window gets visible to the user again (unless the
                // no-reload-button had been clicked).
                document.addEventListener('visibilitychange', () => {
                    if (document.visibilityState === 'visible' && button.disabled !== true) {
                        location.reload();
                    }
                });
            });
        </script>
    </head>
    <body>
        <button>Disable auto-reloading</button>
        <pre>{{ logContent }}</pre>
        <div id="bottom"></div>
    </body>
</html>
